# ------------------------------------------------------------------------------
#### 全般
#### https://wiki.archlinuxjp.org/index.php/Tmux

# プレフィックスを C-t にする
unbind C-b
set -g prefix C-t
bind C-t send-prefix

# スクロールバッファサイズを10000行にする
set -g history-limit 10000

# Escape の入力を遅延しない
# https://ja.stackoverflow.com/questions/24312/tmux-conf-の-escape-time-について
set-option -s escape-time 0

# r で設定ファイルをリロードする
bind r source-file ~/.tmux.conf \; display "Reloaded!"


# ------------------------------------------------------------------------------
#### ステータスライン
#### http://qiita.com/nojima/items/9bc576c922da3604a72b

# ステータスバーをトップに配置する
set-option -g status-position top

# status line を更新する間隔を 1 秒にする
set-option -g status-interval 1

# status-left の最大の長さ
set-option -g status-left-length 30

# status-left のフォーマット
#   #H => マシン名
#   #P => カレントペインのインデックス
set-option -g status-left '#[fg=cyan,bg=default]#{?client_prefix,#[reverse],} #H[#P] #[default]'

# window-status を中央揃えで配置
set-option -g status-justify "centre"

# window-status のフォーマット
#   #I => カレントウィンドウのインデックス
#   #W => カレントウィンドウの名前
set-window-option -g window-status-format         " #I:#W "
set-window-option -g window-status-current-format "#[fg=brightred,bg=default,bold] #I:#W #[default]"

# status-right のフォーマット
#   #S => セッション名
set-option -g status-right "[#S] [%Y-%m-%d(%a) %H:%M]"


# ------------------------------------------------------------------------------
#### COLOUR (Solarized dark)

# default statusbar colors
set-option -g status-bg black #base02
set-option -g status-fg yellow #yellow
set-option -g status-attr default

# default window title colors
set-window-option -g window-status-fg brightblue #base0
set-window-option -g window-status-bg default
#set-window-option -g window-status-attr dim

# active window title colors
set-window-option -g window-status-current-fg brightred #orange
set-window-option -g window-status-current-bg default
#set-window-option -g window-status-current-attr bright

# pane border
set-option -g pane-border-fg black #base02
set-option -g pane-active-border-fg brightgreen #base01

# message text
set-option -g message-bg black #base02
set-option -g message-fg brightred #orange

# pane number display
set-option -g display-panes-active-colour blue #blue
set-option -g display-panes-colour brightred #orange

# clock
set-window-option -g clock-mode-colour green #green

# bell
set-window-option -g window-status-bell-style fg=black,bg=red #base02, red


# ------------------------------------------------------------------------------
#### コピーモード
#### http://qiita.com/b4b4r07/items/01359e8a3066d1c37edc

# Vi キーバインド
set-window-option -g mode-keys vi

# v でコピーモード
bind-key v copy-mode \; display "Copy mode!"

# v で選択開始
bind-key -t vi-copy v       begin-selection
# V で行選択
bind-key -t vi-copy V       select-line
# Ctrl-v で矩形選択トグル
bind-key -t vi-copy C-v     rectangle-toggle

# Enter／y でコピー
bind-key -t vi-copy Enter   copy-pipe "reattach-to-user-namespace pbcopy"
bind-key -t vi-copy y       copy-pipe "reattach-to-user-namespace pbcopy"

# Esc／Ctrl-[ でコピーの反転を解除（コピーモードは抜けない）
bind-key -t vi-copy Escape  clear-selection
bind-key -t vi-copy 'C-['   clear-selection

# q／Ctrl-c でコピーの反転を解除し、コピーモードから抜ける
bind-key -t vi-copy q       cancel
bind-key -t vi-copy C-c     cancel

# Ctrl-a, Ctrl-e で行頭・行末
bind-key -t vi-copy C-a     start-of-line
bind-key -t vi-copy C-e     end-of-line

# 単語単位の移動
bind-key -t vi-copy w       next-word
bind-key -t vi-copy e       next-word-end
bind-key -t vi-copy b       previous-word

# ページスクロール
bind-key -t vi-copy C-b     page-up
bind-key -t vi-copy C-f     page-down
# ページ送り
bind-key -t vi-copy C-u     scroll-up
bind-key -t vi-copy C-d     scroll-down
 
# 前方検索
bind-key -t vi-copy /       search-forward

# Prefix+p でペースト(クリップボードにも保存されているので Cmd-v でもペースト可能)
bind-key p paste-buffer


# ------------------------------------------------------------------------------
#### ウィンドウ／ペイン操作
#### http://qiita.com/b4b4r07/items/01359e8a3066d1c37edc

# ウィンドウとペインの番号を1から開始する（デフォルト0）
set-option -g base-index 1
set-window-option -g pane-base-index 1

# n, N でウィンドウ切り替え
bind-key -r n select-window -t :+
bind-key -r N select-window -t :-

# Ctrl-v, Ctrl-s でペインを縦横に分割
bind-key C-v split-window -h
bind-key C-s split-window -v

# hjkl でペインを移動
bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r l select-pane -R

# HJKL でペインのサイズ変更
bind-key -r H resize-pane -L 5
bind-key -r J resize-pane -D 5
bind-key -r K resize-pane -U 5
bind-key -r L resize-pane -R 5

# Ctrl-t で直前のペインを表示
bind-key C-t last-pane


# ------------------------------------------------------------------------------
#### マウス(トラックパッド)

# マウス(トラックパッド)でバッファをスクロールする
# https://saitodev.co/article/tmuxでマウススクロールをした時、履歴ではなくスクロールしてほしい
set -g mouse on
set -g terminal-overrides 'xterm*:smcup@:rmcup@'

